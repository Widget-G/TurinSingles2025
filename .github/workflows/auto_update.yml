name: Auto Update ATP Finals 2025 ICS

on:
  schedule:
    - cron: "0 */6 * * *"  # ‚è∞ co 6 godzin
  workflow_dispatch:       # ‚ûï mo≈ºliwo≈õƒá uruchomienia rƒôcznie

jobs:
  update-ics:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install icalendar requests beautifulsoup4 pytz

      - name: Generate updated ICS
        run: |
          python generate_ics.py

- name: Commit and push changes
  run: |
    git config --global user.name "github-actions[bot]"
    git config --global user.email "github-actions[bot]@users.noreply.github.com"
    git add .
    git commit -m "Auto-update ATP Finals 2025 schedule" || echo "‚ö†Ô∏è Brak zmian do commitowania"
    git push https://x-access-token:${{ secrets.GITHUB_TOKEN }}@github.com/Widget-G/TurinSingles2025.git
  env:
    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Send Push Notification (ntfy)
        if: success()
        run: |
          curl -H "Title: üéæ ATP Finals 2025 Update" \
               -H "Priority: 4" \
               -H "Tags: tennis,calendar,rocket" \
               -d "Nowy plan mecz√≥w zosta≈Ç opublikowany i Tw√≥j kalendarz .ics zosta≈Ç zaktualizowany! üìÖ" \
               https://ntfy.sh/kgforce_atp2025
